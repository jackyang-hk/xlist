/*!build time : 2014-07-15 1:35:09 PM*/
KISSY.add("gallery/xlist/1.0/plugin/scrollbar",function(a,b,c){var d=a.all,e=60,f=5,g=c.extend({initializer:function(){var b=this;b.userConfig=a.merge({},b.userConfig),b.xlist=b.userConfig.xlist,b.xlist.on("sync",function(){b.set("containerHeight",b.xlist.containerHeight),b.set("indicateHeight",b.xlist.height),b.set("offsetTop",b.xlist.getOffsetTop()),b.render(),b._bindEvt()})},render:function(){var a=this;if(!a.__isRender){a.__isRender=!0;var b=a.xlist,c="<div></div>";a.$scrollbar=d(c).css({width:"3px",position:"absolute",bottom:"2px",top:"2px",right:"2px",zIndex:999,overflow:"hidden","-webkit-border-radius":"2px"}).prependTo(b.$renderTo),a.set("barWrapperHeight",a.$scrollbar.height()||0);var e="<div></div>";a.$indicate=d(e).css({"-webkit-box-sizing":"border-box",position:"absolute",background:"rgba(0,0,0,0.3)","-webkit-border-radius":"1.5px"}).prependTo(a.$scrollbar).css({width:"100%"}),a._update()}},_update:function(){var a=this,b=a.computeScrollBar(Math.abs(a.get("offsetTop")));a._moveTo(b.top),a.$indicate.height(b.height)},computeScrollBar:function(a){var b=this,a=a||0,c=b.get("indicateHeight"),d=b.get("containerHeight"),g=b.get("barWrapperHeight"),h=a/d,i=g*h,j=g*c/d,k=i*(g-e+j)/g;if(e>j&&(j=e,i=k),0>i)i=Math.abs(a)*j/e>j-f?f-j:a*j/e;else if(i+j>c){var l=a-d+c;i=l*j/e>j-f?c-f:c-j+l*j/e}return b.set("barOffsetTop",i),{height:j,top:i}},_scrollTo:function(a,b,c){var d=this;d.show(),d.$indicate[0].style.webkitTransform="translateY("+a+"px)",d.$indicate[0].style.webkitTransition=[b,"s ",c," 0"].join("")},_moveTo:function(a){var b=this;b.show(),b.$indicate[0].style.webkitTransform="translateY("+a+"px)",b.$indicate[0].style.webkitTransition=""},_bindEvt:function(){var a=this;a.__isEvtBind||(a.__isEvtBind=!0,a.xlist.on("drag",function(){a._moveTo(a.computeScrollBar(-a.xlist.getOffsetTop()).top)}),a.xlist.on("scrollTo",function(b){a._scrollTo(a.computeScrollBar(b.offsetTop).top,b.duration,b.easing)}),a.xlist.on("dragStart",function(){a.isBoundryBounce=!1}),a.xlist.on("outOfBoundry",function(){a.isBoundryBounce=!0}),a.xlist.on("scrollEnd",function(b){a.isBoundryBounce||"tapHold"==b.originType||a._moveTo(a.computeScrollBar(-a.xlist.getOffsetTop()).top)}),d(window).on("resize",function(){a._update()}),a.on("afterOffsetTopChange",function(){a._update()}),a.on("afterIndicateHeightChange",function(){a._update()}),a.on("afterContainerHeightChange",function(){a._update()}))},hide:function(){var a=this;a.$scrollbar.css({opacity:0}),a.$scrollbar[0].style.webkitTransition="opacity 0.3s ease-out"},show:function(){var a=this;a.$scrollbar.css({opacity:1})}},{ATTRS:{offsetTop:{value:0},containerHeight:{value:0},indicateHeight:{value:0},barWrapperHeight:{value:0},barHeight:{value:0},barOffsetTop:{value:0}}});return g},{requires:["node","base","anim"]});