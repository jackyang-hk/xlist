/*!build time : 2014-08-02 9:20:42 AM*/
KISSY.add("kg/xlist/3.0.0/index",function(a,b,c,d,e){var f=a.all,g=e.prefixStyle("transform"),h=d.extend({initializer:function(){var b=this,c=b.userConfig=a.mix({data:[],autoRender:!1,itemHeight:30},b.userConfig,void 0,void 0,!0);b.$renderTo.css({overflowY:"hidden"}),clsPrefix=c.clsPrefix||"ks-xlist-",b.containerClsName=clsPrefix+"container",b.contentClsName=clsPrefix+"content",b.visibleIndex={},b.__stickiesRecord={},b.initItemPool(),c.autoRender&&b.render()},initItemPool:function(){var a=this;a.__renderDomRecord={};{var b=a.userConfig;a.itemPool={items:[],visibleItems:{},getItem:function(c,d,e){var g;return e?(g=e,g.element.innerHTML=b.renderHook({item:g,data:c.data,row:Number(d)}).innerHTML):this.items.length?(g=this.items.pop(),g.element.innerHTML=b.renderHook({item:g,data:c.data,row:Number(d)}).innerHTML):(g={template:c.template,element:b.renderHook({item:g,data:c.data,row:Number(d)})},a.__renderDomRecord[c.row]=f(g.element).appendTo(a.$ctn)),this.visibleItems[d]=g,g},returnItem:function(a,b){delete this.visibleItems[b],this.items.push(a)}}}},getDomInfo:function(){for(var a=this,b=a.userConfig,c=b.stickies||{},d=b.data,e=b.itemHeight,f=0,g=[],h=function(){var a=0;for(var b in c)a++;return d.length+a}(),i=0,j=0,k=0;h>k;k++){var l={};if(k in c){j++,i=c[k].height;for(var m in c[k])"type"!=k&&"template"!=k&&(l[m]=c[k][m]);l.type=c[k].type||2,l.template=c[k].template||""}else i=e,l.data=d[k-j],l.template=b.template,l.type=1;l.row=k,l.top=f,l.height=i,g.push(l),f+=i}return a.domInfo=g,g},getItemObj:function(a,b,c){var d=this,e=(d.velocityY||0,d.userConfig),f=d.userConfig.itemHeight,g=e.maxBufferedNum>=0?e.maxBufferedNum:0,h=a-g*f;0>h&&(h=0);for(var i,j={},k=0,l=c.length;l>k;k++)i=c[k],i.top>=h-f&&i.top<=h+2*g*f+b&&(j[i.row]=i);return j},render:function(){var a=this;a.callSuper(),a.getDomInfo();var b=(a.userConfig,a.get("height")),c=a.domInfo.length,d=a.domInfo[c-1],e=(a.$renderTo,a.$ctn),f=e[0],h=a.getItemObj(-a.getOffsetTop(),b,a.domInfo),i=d&&d.top?d.top+d.height:a.height;i<a.height&&(i=a.height),a.set("containerHeight",i),a.$ctn.height(i);for(var j=0,k=a.domInfo.length;k>j;j++)if(2==a.domInfo[j].type&&!a.__stickiesRecord[a.domInfo[j].row]){var l=document.createElement("div");l.style.top=0,l.style.width="100%",l.style.height=a.domInfo[j].height,l.style.position="absolute",l.style[g]=a.domInfo[j].top,l.innerHTML=a.domInfo[j].template||"",f.appendChild(l),a.__stickiesRecord[a.domInfo[j].row]=l}for(var j in a.itemPool.visibleItems)h[j]&&a.itemPool.getItem(h[j],j,a.itemPool.visibleItems[j]);a._bindEvt(),a.scrollTo({x:0,y:0})},_bindEvt:function(){var a=this;a.callSuper(),a.on("scroll",function(b){a.update(b.offset.y)})},update:function(a){var b=this,c=b.userConfig,d=(b.$ctn[0],b.itemPool),e=(c.itemHeight,b.get("height")),a=a||b.getOffsetTop(),f=b.getItemObj(-a,e,b.domInfo);for(var h in f){var i=null;b.visibleIndex[h]||2==f[h].type||(i=d.getItem(f[h],h),i.element.style.position="absolute",i.element.style.height=f[h].height+"px",i.element.style[g]="translateY("+f[h].top+"px)",b.visibleIndex[h]=i)}for(var h in b.visibleIndex)f.hasOwnProperty(h)||(d.returnItem(b.visibleIndex[h],h),delete b.visibleIndex[h])}});return h},{requires:["node","event","kg/xscroll/1.1.0/index","kg/xscroll/1.1.0/util"]});