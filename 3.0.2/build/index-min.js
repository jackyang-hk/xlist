/*!build time : 2014-09-09 11:46:43 AM*/
KISSY.add("kg/xlist/3.0.2/dataset",function(){var a=function(a){this.data=a&&a.data||[],this.id=a&&a.id||"_ds_"+Date.now()};return a.prototype.appendData=function(a){this.data=this.data.concat(a)},a.prototype.removeData=function(){this.data=[]},a.prototype.getData=function(){return this.data},a.prototype.setId=function(a){return a?(this.id=a,this.id):void 0},a.prototype.getId=function(){return this.id},a}),KISSY.add("kg/xlist/3.0.2/index",function(a,b,c,d,e,f){var g=(a.all,e.prefixStyle("transform")),h=d.extend({initializer:function(){var b=this,c=b.userConfig=a.mix({data:[],itemHeight:30},b.userConfig,void 0,void 0,!0);clsPrefix=c.clsPrefix||"ks-xlist-",b.containerClsName=clsPrefix+"container",b.contentClsName=clsPrefix+"content",b._initInfinite(),b.callSuper()},_getDomInfo:function(){var a=this,b=a._formatData(),c=a.userConfig.itemHeight,d=0,e=[],f=0;a.hasSticky=!1;for(var g=0,h=b.length;h>g;g++){var i=b[g];f=i.style&&i.style.height||c,i._row=g,i._top=d,i._height=f,i.recycled=i.recycled===!1?!1:!0,e.push(i),d+=f,!a.hasSticky&&i.style&&"sticky"==i.style.position&&(a.hasSticky=!0)}return a.domInfo=e,e},appendDataSet:function(a){var b=this;!a instanceof f||b.datasets.push(a)},removeDataSet:function(a){var b=this;if(a)for(var c=0,d=b.datasets.length;d>c;c++)a==b.datasets[c].getId()&&b.datasets[c].splice(c,1)},getDataSets:function(){var a=this;return a.datasets},_formatData:function(){var a=this,b=[];for(var c in a.datasets)b=b.concat(a.datasets[c].getData());return b},render:function(){var a=this;a.callSuper(),a._getDomInfo(),a._initSticky();var b=a.get("height"),c=a.domInfo[a.domInfo.length-1],d=c&&c._top?c._top+c._height:a.height;b>d&&(d=b),a.set("containerHeight",d),a._renderNoRecycledEl(),a._update(0,!0)},_renderNoRecycledEl:function(){var a=this;for(var b in a.domInfo)if(a.domInfo[b].recycled===!1&&a.domInfo[b].id){var c=document.getElementById(a.domInfo[b].id.replace("#",""));c||(c=document.createElement("div"),c.id=a.domInfo[b].id,a.$content.append(c));for(var d in a.domInfo[b].style)"height"!=d&&"display"!=d&&"position"!=d&&(c.style[d]=a.domInfo[b].style[d]);c.style.position="absolute",c.style.top=0,c.style.display="block",c.style.height=a.domInfo[b]._height+"px",c.style[g]="translateY("+a.domInfo[b]._top+"px) translateZ(0)",a.domInfo[b].className&&(c.className=a.domInfo[b].className),a.userConfig.renderHook.call(a,c,a.domInfo[b])}},_initSticky:function(){var a=this;if(a.hasSticky&&!a._isStickyRendered){a._isStickyRendered=!0;var b=document.createElement("div");b.style.position="absolute",b.style.top="0",b.style.display="none",a.$renderTo.prepend(b),a.stickyElement=b,a.stickyDomInfo=[];for(var c=0,d=a.domInfo.length;d>c;c++)a.domInfo[c]&&a.domInfo[c].style&&"sticky"==a.domInfo[c].style.position&&a.stickyDomInfo.push(a.domInfo[c]);a.stickyDomInfoLength=a.stickyDomInfo.length}},_initInfinite:function(){var a=this,b=a.userConfig.infiniteElements;a.datasets=[],a.userConfig.data&&a.userConfig.data.length&&a.datasets.push(new f({data:a.userConfig.data})),a.infiniteElements=a.$renderTo[0].querySelectorAll(b),a.infiniteLength=a.infiniteElements.length,a.infiniteElementsCache=function(){for(var b=[],c=0;c<a.infiniteLength;c++)b.push({}),a.infiniteElements[c].style.display="none";return b}(),a.elementsPos={},a.on("scroll",function(b){a._update(b.offset.y),a._stickyHandler(b.offset.y)})},_stickyHandler:function(a){var b=this;if(b.stickyDomInfoLength){if(a>0)return void(b.stickyElement.style.display="none");for(var a=Math.abs(a),c=0;c<b.stickyDomInfoLength;c++)if(a>=b.stickyDomInfo[c]._top){b.userConfig.renderHook.call(b,b.stickyElement,b.stickyDomInfo[c]),b.stickyElement.style.display="block",b.stickyElement.style.height=b.stickyDomInfo[c].style.height+"px",b.stickyElement.className=b.stickyDomInfo[c].className||"";for(var d in b.stickyDomInfo[c].style)"height"!=d&&"display"!=d&&"position"!=d&&(b.stickyElement.style[d]=b.stickyDomInfo[c].style[d])}else c!=b.stickyDomInfoLength-1&&(b.stickyElement.style.display="none")}},_getElementsPos:function(a){for(var b,c=this,a=-(a||c.getOffsetTop()),d=c.domInfo,e=c.userConfig.itemHeight,f=Math.ceil(c.get("height")/e),g=Math.max(Math.ceil(f/3),0),h=Math.max(a-g*e,0),i={},j=0,k=d.length;k>j;j++)b=d[j],b._top>=h-e&&b._top<=h+2*g*e+c.get("height")&&(i[b._row]=b);return i},_getChangedRows:function(a,b){var c=this,d={};for(var e in c.elementsPos)a.hasOwnProperty(e)||(d[e]="delete");for(var e in a)!a[e].recycled||c.elementsPos.hasOwnProperty(e)&&!b||(d[e]="add");return c.elementsPos=a,d},_update:function(a,b){var c=this,a=a||c.getOffsetTop(),d=c._getElementsPos(a),e=c._getChangedRows(d,b),f=null,h=function(){for(var a=0;a<c.infiniteLength;a++)if(!c.infiniteElementsCache[a]._visible)return c.infiniteElementsCache[a]._visible=!0,a},i=function(a){for(var b=0;b<c.infiniteLength;b++)c.infiniteElementsCache[b]._row==a&&(c.infiniteElementsCache[b]._visible=!1,delete c.infiniteElementsCache[b]._row)};for(var j in e)if("delete"==e[j]&&i(j),"add"==e[j]){var k=h(d[j]._row);if(f=c.infiniteElements[k]){c.infiniteElementsCache[k]._row=d[j]._row;for(var l in d[j].style)"height"!=l&&"display"!=l&&"position"!=l&&(f.style[l]=d[j].style[l]);f.style.position="absolute",f.style.top=0,f.style.display="block",f.style.height=d[j]._height+"px",f.style[g]="translateY("+d[j]._top+"px) translateZ(0)",c.userConfig.renderHook.call(c,f,d[j])}}}},{ATTRS:{lockX:{value:!0}}});return h.DataSet=f,h},{requires:["node","event","kg/xscroll/1.1.6/index","kg/xscroll/1.1.6/util","./dataset"]});